---
title: "Business Intelligence Project"
author: "Business Inteligent"
date: "10/16/2023"
output:
  github_document: 
    toc: yes
    toc_depth: 4
    fig_width: 6
    fig_height: 4
    df_print: default
editor_options:
  chunk_output_type: console
---

# Student Details

|                                              |     |
|----------------------------------------------|-----|
| **Student ID Number**                        |136346 |127559|134775|135863|134141
| **Student Name**                             |Ngumi Joshua |Joseph Watunu |Hakeem Alavi |Muema Ian |Aicha Mbongo
| **BBIT 4.2 Group**                           | C |
| **BI Project Group Name/ID (if applicable)** | â€¦   |

# Setup Chunk

**Note:** the following KnitR options have been set as the global defaults: <BR> `knitr::opts_chunk$set(echo = TRUE, warning = FALSE, eval = TRUE, collapse = FALSE, tidy = TRUE)`.

More KnitR options are documented here <https://bookdown.org/yihui/rmarkdown-cookbook/chunk-options.html> and here <https://yihui.org/knitr/options/>.

```{r setup, include=FALSE}
library(formatR)
knitr::opts_chunk$set(
  warning = FALSE,
  collapse = FALSE
)
```

# Understanding the Dataset (Exploratory Data Analysis (EDA))

## Loading the Dataset

### Source:

The dataset that was used can be downloaded here: *data/20230412-20230719-BI1-BBIT4-1-StudentPerformanceDataset.CSV*

### Reference:

*\<Cite the dataset here using APA\>\
Refer to the APA 7th edition manual for rules on how to cite datasets: <https://apastyle.apa.org/style-grammar-guidelines/references/examples/data-set-references>*

```{r Dataset Loader}
library(readr)

# Provide the executable R code inside the various code chunks as guided by the
# lab work.
```

## STEP 1. Install and Load the Required Packages ----

```{r install-packages, message=FALSE, warning=FALSE}
##Code Chunk 1: Package Installation and Loading
install_and_load_package <- function(package_name) {
  if (!is.element(package_name, installed.packages()[, 1])) {
    install.packages(package_name, dependencies = TRUE,
                     repos = "https://cloud.r-project.org")
  }
  require(package_name, character.only = TRUE)
}

# List of packages
packages <- c("dplyr", "ggplot2", "ggrepel", "ggraph", "tidytext",
              "tidyr", "widyr", "gridExtra", "knitr", "kableExtra",
              "formattable", "circlize", "memery", "magick", "yarrr",
              "radarchart", "igraph", "wordcloud2", "readr", "caret",
              "e1071", "factoextra", "FactoMineR")

# Install and load packages
lapply(packages, install_and_load_package)

```

## STEP 2. Customize the Visualizations, Tables, and Colour Scheme ----

```{r custom-theme}
#Code Chunk 2: Custom Theme and Table Styling
# Custom theme for visualizations
blue_grey_theme <- function() {
  # Your existing theme code
}

# Customize the text tables for consistency using HTML formatting
kable_theme <- function(dat, caption) {
  kable(dat, "html", escape = FALSE, caption = caption) %>%
    kable_styling(bootstrap_options = c("striped", "condensed", "bordered"),
                  full_width = FALSE)
}

```

## STEP 3. Load the Dataset ----

```{r load-dataset}
#Code Chunk 3: Data Loading
student_performance_dataset <-
  readr::read_csv(
    "../data/20230412-20230719-BI1-BBIT4-1-StudentPerformanceDataset.CSV", # nolint
    col_types =
      readr::cols(
        class_group =
          readr::col_factor(levels = c("A", "B", "C")),
        gender = readr::col_factor(levels = c("1", "0")),
        YOB = readr::col_date(format = "%Y"),
        regret_choosing_bi =
          readr::col_factor(levels = c("1", "0")),
        drop_bi_now =
          readr::col_factor(levels = c("1", "0")),
        motivator =
          readr::col_factor(levels = c("1", "0")),
        read_content_before_lecture =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        anticipate_test_questions =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        answer_rhetorical_questions =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        find_terms_I_do_not_know =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        copy_new_terms_in_reading_notebook =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        take_quizzes_and_use_results =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        reorganise_course_outline =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        write_down_important_points =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        space_out_revision =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        studying_in_study_group =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        schedule_appointments =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        goal_oriented =
          readr::col_factor(levels =
                              c("1", "0")),
        spaced_repetition =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        testing_and_active_recall =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        interleaving =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        categorizing =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        retrospective_timetable =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        cornell_notes =
          readr::col_factor(levels =
                              c("1", "2", "3", "4")),
        sq3r = readr::col_factor(levels =
                                   c("1", "2", "3", "4")),
        commute = readr::col_factor(levels =
                                      c("1", "2",
                                        "3", "4")),
        study_time = readr::col_factor(levels =
                                         c("1", "2",
                                           "3", "4")),
        repeats_since_Y1 = readr::col_integer(),
        paid_tuition = readr::col_factor(levels =
                                           c("0", "1")),
        free_tuition = readr::col_factor(levels =
                                           c("0", "1")),
        extra_curricular = readr::col_factor(levels =
                                               c("0", "1")),
        sports_extra_curricular =
          readr::col_factor(levels = c("0", "1")),
        exercise_per_week = readr::col_factor(levels =
                                                c("0", "1",
                                                  "2",
                                                  "3")),
        meditate = readr::col_factor(levels =
                                       c("0", "1",
                                         "2", "3")),
        pray = readr::col_factor(levels =
                                   c("0", "1",
                                     "2", "3")),
        internet = readr::col_factor(levels =
                                       c("0", "1")),
        laptop = readr::col_factor(levels = c("0", "1")),
        family_relationships =
          readr::col_factor(levels =
                              c("1", "2", "3", "4", "5")),
        friendships = readr::col_factor(levels =
                                          c("1", "2", "3",
                                            "4", "5")),
        romantic_relationships =
          readr::col_factor(levels =
                              c("0", "1", "2", "3", "4")),
        spiritual_wellnes =
          readr::col_factor(levels = c("1", "2", "3",
                                       "4", "5")),
        financial_wellness =
          readr::col_factor(levels = c("1", "2", "3",
                                       "4", "5")),
        health = readr::col_factor(levels = c("1", "2",
                                              "3", "4",
                                              "5")),
        day_out = readr::col_factor(levels = c("0", "1",
                                               "2", "3")),
        night_out = readr::col_factor(levels = c("0",
                                                 "1", "2",
                                                 "3")),
        alcohol_or_narcotics =
          readr::col_factor(levels = c("0", "1", "2", "3")),
        mentor = readr::col_factor(levels = c("0", "1")),
        mentor_meetings = readr::col_factor(levels =
                                              c("0", "1",
                                                "2", "3")),
        `Attendance Waiver Granted: 1 = Yes, 0 = No` =
          readr::col_factor(levels = c("0", "1")),
        GRADE = readr::col_factor(levels =
                                    c("A", "B", "C", "D",
                                      "E"))),
    locale = readr::locale())

View(student_performance_dataset)

# Dimensions
dim(student_performance_dataset)

# Data Types
sapply(student_performance_dataset, class)
glimpse(student_performance_dataset)

# Summary of each variable
summary(student_performance_dataset)


```

## STEP 4. Apply a Scale and Centre Data Transform ----

```{r scale-transform, center-transform}
# Code Chunk 4: Data Transformation (Scale, Center, Standardize, Normalize)

# Function for data transformation
transform_data <- function(data, method) {
  numeric_columns <- sapply(data, is.numeric)
  numeric_data <- data[, numeric_columns]
  
  model_of_the_transform <- preProcess(numeric_data, method = method)
  transformed_data <- predict(model_of_the_transform, numeric_data)
  
  return(transformed_data)
}

# Apply transformations
methods <- c("scale", "center", "scale", "range")  
transformed_data <- lapply(methods, transform_data, data = student_performance_dataset)




```

## STEP 5. Apply a Standardize Data Transform ----

```{r Standardize Data Transform}


```

## STEP 6. Apply a Normalize Data Transform ----

```{rNormalize Data Transform}
# Create a model for normalization transformation
model_of_the_transform <- preProcess(student_performance_scale_transform[, numeric_columns], method = c("range"))

# Print the details of the transformation
print(model_of_the_transform)

# Apply normalization transformation
student_performance_normalize_transform <- predict(model_of_the_transform, student_performance_scale_transform[, numeric_columns])

# Display summary statistics of the normalized dataset
summary(student_performance_normalize_transform)
```

## STEP 7. Apply a Box-Cox Power Transform ----

```{r Box-Cox Power Transform}


```

## STEP 8. Apply a Yeo-Johnson Power Transform ----

```{r  Yeo-Johnson Power Transform}


```

## STEP 9.a. PCA Linear Algebra Transform for Dimensionality Reduction ----

```{r PCA Linear Algebra Transform}

```

## STEP 10. ICA Linear Algebra Transform for Dimensionality Reduction ----

```{r ICA Linear Algebra Transform}

```
